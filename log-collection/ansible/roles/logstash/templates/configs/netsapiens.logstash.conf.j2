input {
	jdbc {
		jdbc_driver_library => "/usr/share/java/mysql-connector-java-8.0.19.jar"
		jdbc_driver_class => "com.mysql.jdbc.Driver"

		jdbc_connection_string => "{{ mysql.connection_string }}"
		jdbc_user => "{{ mysql.user}}"
		jdbc_password => "{{ mysql.password }}"

		statement => "SELECT event_index, hostname, event_type, orig_callid, event_text, event_ts, event_time FROM {{ mysql.table }} WHERE event_type='responder' AND event_index > :sql_last_value"
                schedule => "*/10 * * * *"
                use_column_value => true
                tracking_column => "event_index"
	}
}

filter {
  mutate {
    rename => {
      "orig_callid" => "call-id"
    }
    rename => {
      "event_text" => "message"
    }
  }
  date {
    match => ["event_ts", "UNIX_MS"]
  }
}
